using NUnit.Framework;

using CSharpCAD;

namespace CSharpCADTests;

[TestFixture]
public class CylinderEllipticTests
{
    [SetUp]
    public void Setup()
    {
    }

    [Test]
    public void TestCylinderEllipticDefaults()
    {
        var obs = CylinderElliptic();
        Assert.DoesNotThrow(() => obs.Validate());
        var pts = obs.ToPoints();

        Assert.AreEqual(pts.Count, 96);
    }

    [Test]
    public void TestCylinderEllipticOptions()
    {
        // test height
        var obs = CylinderElliptic(height: 10, segments: 12);
        Assert.DoesNotThrow(() => obs.Validate());
        var pts = obs.ToPoints();
        var exp = new List<List<Vec3>> {
          new List<Vec3> {new Vec3(0, 0, -5), new Vec3(0.8660254037844387, 0.49999999999999994, -5), new Vec3(1, 0, -5)},
          new List<Vec3> {new Vec3(0.8660254037844387, 0.49999999999999994, -5), new Vec3(0.8660254037844387, 0.49999999999999994, 5),
            new Vec3(1, 0, 5), new Vec3(1, 0, -5)},
          new List<Vec3> {new Vec3(0, 0, 5), new Vec3(1, 0, 5), new Vec3(0.8660254037844387, 0.49999999999999994, 5)},
          new List<Vec3> {new Vec3(0, 0, -5), new Vec3(0.5000000000000001, 0.8660254037844386, -5), new Vec3(0.8660254037844387, 0.49999999999999994, -5)},
          new List<Vec3> {new Vec3(0.5000000000000001, 0.8660254037844386, -5), new Vec3(0.5000000000000001, 0.8660254037844386, 5),
            new Vec3(0.8660254037844387, 0.49999999999999994, 5), new Vec3(0.8660254037844387, 0.49999999999999994, -5)},
          new List<Vec3> {new Vec3(0, 0, 5), new Vec3(0.8660254037844387, 0.49999999999999994, 5), new Vec3(0.5000000000000001, 0.8660254037844386, 5)},
          new List<Vec3> {new Vec3(0, 0, -5), new Vec3(6.123233995736766e-17, 1, -5), new Vec3(0.5000000000000001, 0.8660254037844386, -5)},
          new List<Vec3> {new Vec3(6.123233995736766e-17, 1, -5), new Vec3(6.123233995736766e-17, 1, 5),
            new Vec3(0.5000000000000001, 0.8660254037844386, 5), new Vec3(0.5000000000000001, 0.8660254037844386, -5)},
          new List<Vec3> {new Vec3(0, 0, 5), new Vec3(0.5000000000000001, 0.8660254037844386, 5), new Vec3(6.123233995736766e-17, 1, 5)},
          new List<Vec3> {new Vec3(0, 0, -5), new Vec3(-0.4999999999999998, 0.8660254037844387, -5), new Vec3(6.123233995736766e-17, 1, -5)},
          new List<Vec3> {new Vec3(-0.4999999999999998, 0.8660254037844387, -5), new Vec3(-0.4999999999999998, 0.8660254037844387, 5),
            new Vec3(6.123233995736766e-17, 1, 5), new Vec3(6.123233995736766e-17, 1, -5)},
          new List<Vec3> {new Vec3(0, 0, 5), new Vec3(6.123233995736766e-17, 1, 5), new Vec3(-0.4999999999999998, 0.8660254037844387, 5)},
          new List<Vec3> {new Vec3(0, 0, -5), new Vec3(-0.8660254037844387, 0.49999999999999994, -5), new Vec3(-0.4999999999999998, 0.8660254037844387, -5)},
          new List<Vec3> {new Vec3(-0.8660254037844387, 0.49999999999999994, -5), new Vec3(-0.8660254037844387, 0.49999999999999994, 5),
            new Vec3(-0.4999999999999998, 0.8660254037844387, 5), new Vec3(-0.4999999999999998, 0.8660254037844387, -5)},
          new List<Vec3> {new Vec3(0, 0, 5), new Vec3(-0.4999999999999998, 0.8660254037844387, 5), new Vec3(-0.8660254037844387, 0.49999999999999994, 5)},
          new List<Vec3> {new Vec3(0, 0, -5), new Vec3(-1, 1.2246467991473532e-16, -5), new Vec3(-0.8660254037844387, 0.49999999999999994, -5)},
          new List<Vec3> {new Vec3(-1, 1.2246467991473532e-16, -5), new Vec3(-1, 1.2246467991473532e-16, 5),
            new Vec3(-0.8660254037844387, 0.49999999999999994, 5), new Vec3(-0.8660254037844387, 0.49999999999999994, -5)},
          new List<Vec3> {new Vec3(0, 0, 5), new Vec3(-0.8660254037844387, 0.49999999999999994, 5), new Vec3(-1, 1.2246467991473532e-16, 5)},
          new List<Vec3> {new Vec3(0, 0, -5), new Vec3(-0.8660254037844386, -0.5000000000000001, -5), new Vec3(-1, 1.2246467991473532e-16, -5)},
          new List<Vec3> {new Vec3(-0.8660254037844386, -0.5000000000000001, -5), new Vec3(-0.8660254037844386, -0.5000000000000001, 5),
            new Vec3(-1, 1.2246467991473532e-16, 5), new Vec3(-1, 1.2246467991473532e-16, -5)},
          new List<Vec3> {new Vec3(0, 0, 5), new Vec3(-1, 1.2246467991473532e-16, 5), new Vec3(-0.8660254037844386, -0.5000000000000001, 5)},
          new List<Vec3> {new Vec3(0, 0, -5), new Vec3(-0.5000000000000004, -0.8660254037844385, -5), new Vec3(-0.8660254037844386, -0.5000000000000001, -5)},
          new List<Vec3> {new Vec3(-0.5000000000000004, -0.8660254037844385, -5), new Vec3(-0.5000000000000004, -0.8660254037844385, 5),
            new Vec3(-0.8660254037844386, -0.5000000000000001, 5), new Vec3(-0.8660254037844386, -0.5000000000000001, -5)},
          new List<Vec3> {new Vec3(0, 0, 5), new Vec3(-0.8660254037844386, -0.5000000000000001, 5), new Vec3(-0.5000000000000004, -0.8660254037844385, 5)},
          new List<Vec3> {new Vec3(0, 0, -5), new Vec3(-1.8369701987210297e-16, -1, -5), new Vec3(-0.5000000000000004, -0.8660254037844385, -5)},
          new List<Vec3> {new Vec3(-1.8369701987210297e-16, -1, -5), new Vec3(-1.8369701987210297e-16, -1, 5),
            new Vec3(-0.5000000000000004, -0.8660254037844385, 5), new Vec3(-0.5000000000000004, -0.8660254037844385, -5)},
          new List<Vec3> {new Vec3(0, 0, 5), new Vec3(-0.5000000000000004, -0.8660254037844385, 5), new Vec3(-1.8369701987210297e-16, -1, 5)},
          new List<Vec3> {new Vec3(0, 0, -5), new Vec3(0.5000000000000001, -0.8660254037844386, -5), new Vec3(-1.8369701987210297e-16, -1, -5)},
          new List<Vec3> {new Vec3(0.5000000000000001, -0.8660254037844386, -5), new Vec3(0.5000000000000001, -0.8660254037844386, 5),
            new Vec3(-1.8369701987210297e-16, -1, 5), new Vec3(-1.8369701987210297e-16, -1, -5)},
          new List<Vec3> {new Vec3(0, 0, 5), new Vec3(-1.8369701987210297e-16, -1, 5), new Vec3(0.5000000000000001, -0.8660254037844386, 5)},
          new List<Vec3> {new Vec3(0, 0, -5), new Vec3(0.8660254037844384, -0.5000000000000004, -5), new Vec3(0.5000000000000001, -0.8660254037844386, -5)},
          new List<Vec3> {new Vec3(0.8660254037844384, -0.5000000000000004, -5), new Vec3(0.8660254037844384, -0.5000000000000004, 5),
            new Vec3(0.5000000000000001, -0.8660254037844386, 5), new Vec3(0.5000000000000001, -0.8660254037844386, -5)},
          new List<Vec3> {new Vec3(0, 0, 5), new Vec3(0.5000000000000001, -0.8660254037844386, 5), new Vec3(0.8660254037844384, -0.5000000000000004, 5)},
          new List<Vec3> {new Vec3(0, 0, -5), new Vec3(1, -2.4492935982947064e-16, -5), new Vec3(0.8660254037844384, -0.5000000000000004, -5)},
          new List<Vec3> {new Vec3(1, -2.4492935982947064e-16, -5), new Vec3(1, -2.4492935982947064e-16, 5),
            new Vec3(0.8660254037844384, -0.5000000000000004, 5), new Vec3(0.8660254037844384, -0.5000000000000004, -5)},
          new List<Vec3> {new Vec3(0, 0, 5), new Vec3(0.8660254037844384, -0.5000000000000004, 5), new Vec3(1, -2.4492935982947064e-16, 5)}
        };

        Assert.AreEqual(pts.Count, 36);
        Assert.IsTrue(Helpers.CompareListOfListsNEVec3(pts, exp));

        // test startRadius and endRadius
        obs = CylinderElliptic(startRadius: (1, 2), endRadius: (2, 1), segments: 12);
        Assert.DoesNotThrow(() => obs.Validate());
        pts = obs.ToPoints();
        exp = new List<List<Vec3>> {
          new List<Vec3> {new Vec3(0, 0, -1), new Vec3(0.8660254037844387, 0.9999999999999999, -1), new Vec3(1, 0, -1)},
          new List<Vec3> {new Vec3(1, 0, -1), new Vec3(0.8660254037844387, 0.9999999999999999, -1), new Vec3(2, 0, 1)},
          new List<Vec3> {new Vec3(0, 0, 1), new Vec3(2, 0, 1), new Vec3(1.7320508075688774, 0.49999999999999994, 1)},
          new List<Vec3> {new Vec3(2, 0, 1), new Vec3(0.8660254037844387, 0.9999999999999999, -1), new Vec3(1.7320508075688774, 0.49999999999999994, 1)},
          new List<Vec3> {new Vec3(0, 0, -1), new Vec3(0.5000000000000001, 1.7320508075688772, -1), new Vec3(0.8660254037844387, 0.9999999999999999, -1)},
          new List<Vec3> {new Vec3(0.8660254037844387, 0.9999999999999999, -1), new Vec3(0.5000000000000001, 1.7320508075688772, -1), new Vec3(1.7320508075688774, 0.49999999999999994, 1)},
          new List<Vec3> {new Vec3(0, 0, 1), new Vec3(1.7320508075688774, 0.49999999999999994, 1), new Vec3(1.0000000000000002, 0.8660254037844386, 1)},
          new List<Vec3> {new Vec3(1.7320508075688774, 0.49999999999999994, 1), new Vec3(0.5000000000000001, 1.7320508075688772, -1), new Vec3(1.0000000000000002, 0.8660254037844386, 1)},
          new List<Vec3> {new Vec3(0, 0, -1), new Vec3(6.123233995736766e-17, 2, -1), new Vec3(0.5000000000000001, 1.7320508075688772, -1)},
          new List<Vec3> {new Vec3(0.5000000000000001, 1.7320508075688772, -1), new Vec3(6.123233995736766e-17, 2, -1), new Vec3(1.0000000000000002, 0.8660254037844386, 1)},
          new List<Vec3> {new Vec3(0, 0, 1), new Vec3(1.0000000000000002, 0.8660254037844386, 1), new Vec3(1.2246467991473532e-16, 1, 1)},
          new List<Vec3> {new Vec3(1.0000000000000002, 0.8660254037844386, 1), new Vec3(6.123233995736766e-17, 2, -1), new Vec3(1.2246467991473532e-16, 1, 1)},
          new List<Vec3> {new Vec3(0, 0, -1), new Vec3(-0.4999999999999998, 1.7320508075688774, -1), new Vec3(6.123233995736766e-17, 2, -1)},
          new List<Vec3> {new Vec3(6.123233995736766e-17, 2, -1), new Vec3(-0.4999999999999998, 1.7320508075688774, -1), new Vec3(1.2246467991473532e-16, 1, 1)},
          new List<Vec3> {new Vec3(0, 0, 1), new Vec3(1.2246467991473532e-16, 1, 1), new Vec3(-0.9999999999999996, 0.8660254037844387, 1)},
          new List<Vec3> {new Vec3(1.2246467991473532e-16, 1, 1), new Vec3(-0.4999999999999998, 1.7320508075688774, -1), new Vec3(-0.9999999999999996, 0.8660254037844387, 1)},
          new List<Vec3> {new Vec3(0, 0, -1), new Vec3(-0.8660254037844387, 0.9999999999999999, -1), new Vec3(-0.4999999999999998, 1.7320508075688774, -1)},
          new List<Vec3> {new Vec3(-0.4999999999999998, 1.7320508075688774, -1), new Vec3(-0.8660254037844387, 0.9999999999999999, -1), new Vec3(-0.9999999999999996, 0.8660254037844387, 1)},
          new List<Vec3> {new Vec3(0, 0, 1), new Vec3(-0.9999999999999996, 0.8660254037844387, 1), new Vec3(-1.7320508075688774, 0.49999999999999994, 1)},
          new List<Vec3> {new Vec3(-0.9999999999999996, 0.8660254037844387, 1), new Vec3(-0.8660254037844387, 0.9999999999999999, -1), new Vec3(-1.7320508075688774, 0.49999999999999994, 1)},
          new List<Vec3> {new Vec3(0, 0, -1), new Vec3(-1, 2.4492935982947064e-16, -1), new Vec3(-0.8660254037844387, 0.9999999999999999, -1)},
          new List<Vec3> {new Vec3(-0.8660254037844387, 0.9999999999999999, -1), new Vec3(-1, 2.4492935982947064e-16, -1), new Vec3(-1.7320508075688774, 0.49999999999999994, 1)},
          new List<Vec3> {new Vec3(0, 0, 1), new Vec3(-1.7320508075688774, 0.49999999999999994, 1), new Vec3(-2, 1.2246467991473532e-16, 1)},
          new List<Vec3> {new Vec3(-1.7320508075688774, 0.49999999999999994, 1), new Vec3(-1, 2.4492935982947064e-16, -1), new Vec3(-2, 1.2246467991473532e-16, 1)},
          new List<Vec3> {new Vec3(0, 0, -1), new Vec3(-0.8660254037844386, -1.0000000000000002, -1), new Vec3(-1, 2.4492935982947064e-16, -1)},
          new List<Vec3> {new Vec3(-1, 2.4492935982947064e-16, -1), new Vec3(-0.8660254037844386, -1.0000000000000002, -1), new Vec3(-2, 1.2246467991473532e-16, 1)},
          new List<Vec3> {new Vec3(0, 0, 1), new Vec3(-2, 1.2246467991473532e-16, 1), new Vec3(-1.7320508075688772, -0.5000000000000001, 1)},
          new List<Vec3> {new Vec3(-2, 1.2246467991473532e-16, 1), new Vec3(-0.8660254037844386, -1.0000000000000002, -1), new Vec3(-1.7320508075688772, -0.5000000000000001, 1)},
          new List<Vec3> {new Vec3(0, 0, -1), new Vec3(-0.5000000000000004, -1.732050807568877, -1), new Vec3(-0.8660254037844386, -1.0000000000000002, -1)},
          new List<Vec3> {new Vec3(-0.8660254037844386, -1.0000000000000002, -1), new Vec3(-0.5000000000000004, -1.732050807568877, -1), new Vec3(-1.7320508075688772, -0.5000000000000001, 1)},
          new List<Vec3> {new Vec3(0, 0, 1), new Vec3(-1.7320508075688772, -0.5000000000000001, 1), new Vec3(-1.0000000000000009, -0.8660254037844385, 1)},
          new List<Vec3> {new Vec3(-1.7320508075688772, -0.5000000000000001, 1), new Vec3(-0.5000000000000004, -1.732050807568877, -1), new Vec3(-1.0000000000000009, -0.8660254037844385, 1)},
          new List<Vec3> {new Vec3(0, 0, -1), new Vec3(-1.8369701987210297e-16, -2, -1), new Vec3(-0.5000000000000004, -1.732050807568877, -1)},
          new List<Vec3> {new Vec3(-0.5000000000000004, -1.732050807568877, -1), new Vec3(-1.8369701987210297e-16, -2, -1), new Vec3(-1.0000000000000009, -0.8660254037844385, 1)},
          new List<Vec3> {new Vec3(0, 0, 1), new Vec3(-1.0000000000000009, -0.8660254037844385, 1), new Vec3(-3.6739403974420594e-16, -1, 1)},
          new List<Vec3> {new Vec3(-1.0000000000000009, -0.8660254037844385, 1), new Vec3(-1.8369701987210297e-16, -2, -1), new Vec3(-3.6739403974420594e-16, -1, 1)},
          new List<Vec3> {new Vec3(0, 0, -1), new Vec3(0.5000000000000001, -1.7320508075688772, -1), new Vec3(-1.8369701987210297e-16, -2, -1)},
          new List<Vec3> {new Vec3(-1.8369701987210297e-16, -2, -1), new Vec3(0.5000000000000001, -1.7320508075688772, -1), new Vec3(-3.6739403974420594e-16, -1, 1)},
          new List<Vec3> {new Vec3(0, 0, 1), new Vec3(-3.6739403974420594e-16, -1, 1), new Vec3(1.0000000000000002, -0.8660254037844386, 1)},
          new List<Vec3> {new Vec3(-3.6739403974420594e-16, -1, 1), new Vec3(0.5000000000000001, -1.7320508075688772, -1), new Vec3(1.0000000000000002, -0.8660254037844386, 1)},
          new List<Vec3> {new Vec3(0, 0, -1), new Vec3(0.8660254037844384, -1.0000000000000009, -1), new Vec3(0.5000000000000001, -1.7320508075688772, -1)},
          new List<Vec3> {new Vec3(0.5000000000000001, -1.7320508075688772, -1), new Vec3(0.8660254037844384, -1.0000000000000009, -1), new Vec3(1.0000000000000002, -0.8660254037844386, 1)},
          new List<Vec3> {new Vec3(0, 0, 1), new Vec3(1.0000000000000002, -0.8660254037844386, 1), new Vec3(1.7320508075688767, -0.5000000000000004, 1)},
          new List<Vec3> {new Vec3(1.0000000000000002, -0.8660254037844386, 1), new Vec3(0.8660254037844384, -1.0000000000000009, -1), new Vec3(1.7320508075688767, -0.5000000000000004, 1)},
          new List<Vec3> {new Vec3(0, 0, -1), new Vec3(1, -4.898587196589413e-16, -1), new Vec3(0.8660254037844384, -1.0000000000000009, -1)},
          new List<Vec3> {new Vec3(0.8660254037844384, -1.0000000000000009, -1), new Vec3(1, -4.898587196589413e-16, -1), new Vec3(1.7320508075688767, -0.5000000000000004, 1)},
          new List<Vec3> {new Vec3(0, 0, 1), new Vec3(1.7320508075688767, -0.5000000000000004, 1), new Vec3(2, -2.4492935982947064e-16, 1)},
          new List<Vec3> {new Vec3(1.7320508075688767, -0.5000000000000004, 1), new Vec3(1, -4.898587196589413e-16, -1), new Vec3(2, -2.4492935982947064e-16, 1)}
        };

        Assert.AreEqual(pts.Count, 48);
        Assert.IsTrue(Helpers.CompareListOfListsNEVec3(pts, exp));

        // test startAngle and endAngle
        obs = CylinderElliptic(startRadius: (1, 2), endRadius: (2, 1),
          startAngle: Math.PI / 2, endAngle: Math.PI * 2 * 0.75, segments: 12);
        Assert.DoesNotThrow(() => obs.Validate());
        pts = obs.ToPoints();
        exp = new List<List<Vec3>> { };

        Assert.AreEqual(pts.Count, 28);
        // Assert.IsTrue(comparePolygonsAsPoints(pts, exp))

        // test segments
        obs = CylinderElliptic(segments: 8);
        Assert.DoesNotThrow(() => obs.Validate());
        pts = obs.ToPoints();

        Assert.AreEqual(pts.Count, 24);

        // test center
        obs = CylinderElliptic(center: (-5, -5, -5), height: 3, segments: 8);
        Assert.DoesNotThrow(() => obs.Validate());
        pts = obs.ToPoints();
        exp = new List<List<Vec3>> {
          new List<Vec3> {new Vec3(-5, -5, -6.5), new Vec3(-4.292893218813452, -4.292893218813452, -6.5), new Vec3(-4, -5, -6.5)},
          new List<Vec3> {new Vec3(-4.292893218813452, -4.292893218813452, -6.5), new Vec3(-4.292893218813452, -4.292893218813452, -3.5),
            new Vec3(-4, -5, -3.5), new Vec3(-4, -5, -6.5)},
          new List<Vec3> {new Vec3(-5, -5, -3.5), new Vec3(-4, -5, -3.5), new Vec3(-4.292893218813452, -4.292893218813452, -3.5)},
          new List<Vec3> {new Vec3(-5, -5, -6.5), new Vec3(-5, -4, -6.5), new Vec3(-4.292893218813452, -4.292893218813452, -6.5)},
          new List<Vec3> {new Vec3(-5, -4, -6.5), new Vec3(-5, -4, -3.5),
            new Vec3(-4.292893218813452, -4.292893218813452, -3.5), new Vec3(-4.292893218813452, -4.292893218813452, -6.5)},
          new List<Vec3> {new Vec3(-5, -5, -3.5), new Vec3(-4.292893218813452, -4.292893218813452, -3.5), new Vec3(-5, -4, -3.5)},
          new List<Vec3> {new Vec3(-5, -5, -6.5), new Vec3(-5.707106781186548, -4.292893218813452, -6.5), new Vec3(-5, -4, -6.5)},
          new List<Vec3> {new Vec3(-5.707106781186548, -4.292893218813452, -6.5), new Vec3(-5.707106781186548, -4.292893218813452, -3.5),
            new Vec3(-5, -4, -3.5), new Vec3(-5, -4, -6.5)},
          new List<Vec3> {new Vec3(-5, -5, -3.5), new Vec3(-5, -4, -3.5), new Vec3(-5.707106781186548, -4.292893218813452, -3.5)},
          new List<Vec3> {new Vec3(-5, -5, -6.5), new Vec3(-6, -5, -6.5), new Vec3(-5.707106781186548, -4.292893218813452, -6.5)},
          new List<Vec3> {new Vec3(-6, -5, -6.5), new Vec3(-6, -5, -3.5),
            new Vec3(-5.707106781186548, -4.292893218813452, -3.5), new Vec3(-5.707106781186548, -4.292893218813452, -6.5)},
          new List<Vec3> {new Vec3(-5, -5, -3.5), new Vec3(-5.707106781186548, -4.292893218813452, -3.5), new Vec3(-6, -5, -3.5)},
          new List<Vec3> {new Vec3(-5, -5, -6.5), new Vec3(-5.707106781186548, -5.707106781186548, -6.5), new Vec3(-6, -5, -6.5)},
          new List<Vec3> {new Vec3(-5.707106781186548, -5.707106781186548, -6.5), new Vec3(-5.707106781186548, -5.707106781186548, -3.5),
            new Vec3(-6, -5, -3.5), new Vec3(-6, -5, -6.5)},
          new List<Vec3> {new Vec3(-5, -5, -3.5), new Vec3(-6, -5, -3.5), new Vec3(-5.707106781186548, -5.707106781186548, -3.5)},
          new List<Vec3> {new Vec3(-5, -5, -6.5), new Vec3(-5, -6, -6.5), new Vec3(-5.707106781186548, -5.707106781186548, -6.5)},
          new List<Vec3> {new Vec3(-5, -6, -6.5), new Vec3(-5, -6, -3.5),
            new Vec3(-5.707106781186548, -5.707106781186548, -3.5), new Vec3(-5.707106781186548, -5.707106781186548, -6.5)},
          new List<Vec3> {new Vec3(-5, -5, -3.5), new Vec3(-5.707106781186548, -5.707106781186548, -3.5), new Vec3(-5, -6, -3.5)},
          new List<Vec3> {new Vec3(-5, -5, -6.5), new Vec3(-4.292893218813453, -5.707106781186548, -6.5), new Vec3(-5, -6, -6.5)},
          new List<Vec3> {new Vec3(-4.292893218813453, -5.707106781186548, -6.5), new Vec3(-4.292893218813453, -5.707106781186548, -3.5),
            new Vec3(-5, -6, -3.5), new Vec3(-5, -6, -6.5)},
          new List<Vec3> {new Vec3(-5, -5, -3.5), new Vec3(-5, -6, -3.5), new Vec3(-4.292893218813453, -5.707106781186548, -3.5)},
          new List<Vec3> {new Vec3(-5, -5, -6.5), new Vec3(-4, -5, -6.5), new Vec3(-4.292893218813453, -5.707106781186548, -6.5)},
          new List<Vec3> {new Vec3(-4, -5, -6.5), new Vec3(-4, -5, -3.5),
            new Vec3(-4.292893218813453, -5.707106781186548, -3.5), new Vec3(-4.292893218813453, -5.707106781186548, -6.5)},
          new List<Vec3> {new Vec3(-5, -5, -3.5), new Vec3(-4.292893218813453, -5.707106781186548, -3.5), new Vec3(-4, -5, -3.5)}
        };

        Assert.AreEqual(pts.Count, 24);
        Assert.IsTrue(Helpers.CompareListOfListsNEVec3(pts, exp));
    }
}
